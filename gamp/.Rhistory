dplyr::%>%
dplyr::`%>%`
devtools::document()
devtools::document()
library(gamp)
help("sim_fx_diff_noise_tradeoff_2env")
sim_df <- gamp::sim_fx_diff_noise_tradeoff_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
se_grid = seq(from = .025, to = 1, length.out = 10),
fx_norm_diff_grid = seq(from = 0, to = 1, length.out = 10)
)
library(gamp)
sim_df <- gamp::sim_fx_diff_noise_tradeoff_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
se_grid = seq(from = .025, to = 1, length.out = 10),
fx_norm_diff_grid = seq(from = 0, to = 1, length.out = 10)
)
library(gamp)
sim_df <- gamp::sim_fx_diff_noise_tradeoff_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
se_grid = seq(from = .025, to = 1, length.out = 10),
fx_norm_diff_grid = seq(from = 0, to = 1, length.out = 10)
)
sim_df <- gamp::sim_fx_diff_noise_tradeoff_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
se_grid = seq(from = .025, to = 1, length.out = 10),
fx_norm_diff_grid = seq(from = 0, to = 1, length.out = 10)
)
library(gamp)
sim_df <- gamp::sim_fx_diff_noise_tradeoff_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
se_grid = seq(from = .025, to = 1, length.out = 10),
fx_norm_diff_grid = seq(from = 0, to = 1, length.out = 10)
)
View(sim_df)
'%>%' <- magrittr::'%>%'
sim_df <- sim_df %>%
dplyr::mutate(mse_diff = mse_additive - mse_GxE)
library(gamp)
# code for figure 1
set.seed(1)
'%>%' <- magrittr::'%>%'
sim_df <- gamp::sim_fx_diff_noise_tradeoff_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
se_grid = seq(from = .025, to = 1, length.out = 10),
fx_norm_diff_grid = seq(from = 0, to = .5, length.out = 10)
)
sim_df <- sim_df %>%
dplyr::mutate(mse_diff = mse_additive - mse_GxE)
library(gamp)
# code for figure 1
set.seed(1)
'%>%' <- magrittr::'%>%'
sim_df <- gamp::sim_fx_diff_noise_tradeoff_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
se_grid = seq(from = .025, to = 1, length.out = 10),
fx_norm_diff_grid = seq(from = 0, to = .5, length.out = 10)
)
sim_df <- sim_df %>%
dplyr::mutate(mse_diff = mse_additive - mse_GxE)
View(sim_df)
# code for figure 1
set.seed(1)
'%>%' <- magrittr::'%>%'
sim_df <- gamp::sim_fx_diff_noise_tradeoff_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
se_grid = seq(from = .025, to = 1, length.out = 100),
fx_norm_diff_grid = seq(from = 0, to = .05, length.out = 100)
)
sim_df <- sim_df %>%
dplyr::mutate(mse_diff = mse_additive - mse_GxE)
# code for figure 1
set.seed(1)
'%>%' <- magrittr::'%>%'
sim_df <- gamp::sim_fx_diff_noise_tradeoff_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
se_grid = seq(from = .025, to = 1, length.out = 100),
fx_norm_diff_grid = seq(from = 0, to = .05, length.out = 100),
sims_per_grid_pt = 1
)
sim_df <- sim_df %>%
dplyr::mutate(mse_diff = mse_additive - mse_GxE)
View(sim_df)
ggplot(data = sim_df, aes(x = fx_norm_diff, y = se, fill = mse_diff)) +
geom_tile() +
scale_fill_gradient2() +
ylab("Environment Specific SE") +
xlab(latex2exp::TeX("$|\\beta_{1}^{(0)} - \\beta_{1}^{(1)}|$"))
library(ggplot2)
ggplot(data = sim_df, aes(x = fx_norm_diff, y = se, fill = mse_diff)) +
geom_tile() +
scale_fill_gradient2() +
ylab("Environment Specific SE") +
xlab(latex2exp::TeX("$|\\beta_{1}^{(0)} - \\beta_{1}^{(1)}|$"))
# code for figure 1
set.seed(1)
'%>%' <- magrittr::'%>%'
library(ggplot2)
sim_df <- gamp::sim_fx_diff_noise_tradeoff_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
se_grid = seq(from = .025, to = .25, length.out = 100),
fx_norm_diff_grid = seq(from = 0, to = .25, length.out = 100),
sims_per_grid_pt = 1
)
sim_df <- sim_df %>%
dplyr::mutate(mse_diff = mse_additive - mse_GxE)
ggplot(data = sim_df, aes(x = fx_norm_diff, y = se, fill = mse_diff)) +
geom_tile() +
scale_fill_gradient2() +
ylab("Environment Specific SE") +
xlab(latex2exp::TeX("$|\\beta_{1}^{(0)} - \\beta_{1}^{(1)}|$"))
View(sim_df)
sim_df <- sim_df %>%
dplyr::mutate(mse_diff = mse_e1_additive - mse_e1_GxE)
ggplot(data = sim_df, aes(x = fx_norm_diff, y = se, fill = mse_diff)) +
geom_tile() +
scale_fill_gradient2() +
ylab("Environment Specific SE") +
xlab(latex2exp::TeX("$|\\beta_{1}^{(0)} - \\beta_{1}^{(1)}|$"))
set.seed(1)
'%>%' <- magrittr::'%>%'
library(ggplot2)
sim_df <- gamp::sim_fx_diff_noise_tradeoff_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
se_grid = seq(from = .025, to = .5, length.out = 100),
fx_norm_diff_grid = seq(from = 0, to = .1, length.out = 100),
sims_per_grid_pt = 1
)
sim_df <- sim_df %>%
dplyr::mutate(mse_diff = mse_e1_additive - mse_e1_GxE)
ggplot(data = sim_df, aes(x = fx_norm_diff, y = se, fill = mse_diff)) +
geom_tile() +
scale_fill_gradient2() +
ylab("Environment Specific SE") +
xlab(latex2exp::TeX("$\\frac{|\\beta_{1}^{(0)} - \\beta_{1}^{(1)}|}{\\sigma_{0}}$"))
library(gamp)
setwd("~/Documents/academic/gwas_amplification/paper_figures")
# code for figure 1
set.seed(1)
'%>%' <- magrittr::'%>%'
library(ggplot2)
generate_fig1 <- function(sim_df = NULL, write_rds = FALSE) {
if(is.null(sim_df)) {
sim_df <- gamp::sim_fx_diff_noise_tradeoff_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
se_grid = seq(from = .025, to = 1, by = .025),
fx_diff_grid = seq(from = 0, to = 1, by = .025),
sims_per_grid_pt = 1
)
}
if(write_rds) {
readr::write_rds(sim_df, "./rds_data/fig1_df.rds")
}
sim_df <- sim_df %>%
dplyr::mutate(mse_diff_e1 = mse_e1_additive - mse_e1_GxE)
ggplot(data = sim_test, aes(x = fx_diff, y = se, fill = mse_diff_e1)) +
geom_tile() +
scale_fill_gradient2() +
geom_segment(aes(x = .030265, y = 0.02500095, xend = 1, yend = 0.683035), linetype = "dashed") +
coord_fixed() +
ylab("Environment Specific SE") +
xlab(latex2exp::TeX("$|\\beta_{1}^{(0)} - \\beta_{1}^{(1)}|$"))
}
# first time simulation
generate_fig1(write_rds = TRUE)
# code for figure 1
set.seed(1)
'%>%' <- magrittr::'%>%'
library(ggplot2)
generate_fig1 <- function(sim_df = NULL, write_rds = FALSE) {
if(is.null(sim_df)) {
sim_df <- gamp::sim_fx_diff_noise_tradeoff_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
se_grid = seq(from = .025, to = 1, by = .025),
fx_diff_grid = seq(from = 0, to = 1, by = .025),
sims_per_grid_pt = 1
)
}
if(write_rds) {
readr::write_rds(sim_df, "./rds_data/fig1_df.rds")
}
sim_df <- sim_df %>%
dplyr::mutate(mse_diff_e1 = mse_e1_additive - mse_e1_GxE)
ggplot(data = sim_df, aes(x = fx_diff, y = se, fill = mse_diff_e1)) +
geom_tile() +
scale_fill_gradient2() +
geom_segment(aes(x = .030265, y = 0.02500095, xend = 1, yend = 0.683035), linetype = "dashed") +
coord_fixed() +
ylab("Environment Specific SE") +
xlab(latex2exp::TeX("$|\\beta_{1}^{(0)} - \\beta_{1}^{(1)}|$"))
}
# first time simulation
generate_fig1(write_rds = TRUE)
# subsequent analysis
sim_df <- readr::read_rds("./rds_data/fig1_df.rds")
generate_fig1(sim_df)
devtools::document()
setwd("~/Documents/academic/gwas_amplification/gamp/R")
setwd("~/Documents/academic/gwas_amplification/gamp")
devtools::document()
library(gamp)
help("sim_fx_diff_noise_tradeoff_2env")
help("sim_diff_variance_2env")
setwd("~/Documents/academic/gwas_amplification/paper_figures")
# code for figure 2
set.seed(1)
'%>%' <- magrittr::'%>%'
library(ggplot2)
generate_fig2 <- function(sim_df = NULL, write_rds = FALSE) {
if(is.null(sim_df)) {
sim_df <- gamp::sim_diff_variance_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
ref_se = .25,
se_ratio_grid = seq(from = .5, to = 2, length.out = 100),
fx_diff_norm_grid = seq(
from = 0, to = 1, length.out = 100
) / gamp:::get_theo_obs_noise(se = .25, n = 1.5e05, maf = .4),
sims_per_grid_pt = 1
)
}
if(write_rds) {
readr::write_rds(sim_df, "./rds_data/fig2_df.rds")
}
sim_df <- sim_df %>%
dplyr::mutate(mse_diff_e1 = mse_e1_additive - mse_e1_GxE)
ggplot(data = sim_df, aes(x = fx_diff, y = se, fill = mse_diff_e1)) +
geom_tile() +
scale_fill_gradient2() +
ylab(latex2exp::TeX("$\\frac{\sigma_{1}}{\sigma_{0}}$")) +
xlab(latex2exp::TeX("$\\frac{|\\beta_{1}^{(0)} - \\beta_{1}^{(1)}|}{\sigma_{0}}$"))
}
# first time simulation
generate_fig2(write_rds = TRUE)
# code for figure 2
set.seed(1)
'%>%' <- magrittr::'%>%'
library(ggplot2)
generate_fig2 <- function(sim_df = NULL, write_rds = FALSE) {
if(is.null(sim_df)) {
sim_df <- gamp::sim_diff_variance_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
ref_se = .25,
se_ratio_grid = seq(from = .5, to = 2, length.out = 100),
fx_diff_norm_grid = seq(
from = 0, to = 1, length.out = 100
) / gamp:::get_theo_obs_noise(se = .25, n = 1.5e05, maf = .4),
sims_per_grid_pt = 1
)
}
if(write_rds) {
readr::write_rds(sim_df, "./rds_data/fig2_df.rds")
}
sim_df <- sim_df %>%
dplyr::mutate(mse_diff_e1 = mse_e1_additive - mse_e1_GxE)
ggplot(data = sim_df, aes(x = fx_diff, y = se, fill = mse_diff_e1)) +
geom_tile() +
scale_fill_gradient2() +
ylab(latex2exp::TeX("$\\frac{\\sigma_{1}}{\\sigma_{0}}$")) +
xlab(latex2exp::TeX("$\\frac{|\\beta_{1}^{(0)} - \\beta_{1}^{(1)}|}{\\sigma_{0}}$"))
}
# first time simulation
generate_fig2(write_rds = TRUE)
setwd("~/Documents/academic/gwas_amplification/gamp/R")
setwd("~/Documents/academic/gwas_amplification/gamp")
library(gamp)
setwd("~/Documents/academic/gwas_amplification/paper_figures")
set.seed(1)
'%>%' <- magrittr::'%>%'
library(ggplot2)
generate_fig2 <- function(sim_df = NULL, write_rds = FALSE) {
if(is.null(sim_df)) {
sim_df <- gamp::sim_diff_variance_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
ref_se = .25,
se_ratio_grid = seq(from = .5, to = 2, length.out = 100),
fx_diff_norm_grid = seq(
from = 0, to = 1, length.out = 100
) / gamp:::get_theo_obs_noise(se = .25, n = 1.5e05, maf = .4),
sims_per_grid_pt = 1
)
}
if(write_rds) {
readr::write_rds(sim_df, "./rds_data/fig2_df.rds")
}
sim_df <- sim_df %>%
dplyr::mutate(mse_diff_e1 = mse_e1_additive - mse_e1_GxE)
ggplot(data = sim_df, aes(x = fx_diff, y = se, fill = mse_diff_e1)) +
geom_tile() +
scale_fill_gradient2() +
ylab(latex2exp::TeX("$\\frac{\\sigma_{1}}{\\sigma_{0}}$")) +
xlab(latex2exp::TeX("$\\frac{|\\beta_{1}^{(0)} - \\beta_{1}^{(1)}|}{\\sigma_{0}}$"))
}
# first time simulation
generate_fig2(write_rds = TRUE)
# code for figure 2
set.seed(1)
'%>%' <- magrittr::'%>%'
library(ggplot2)
generate_fig2 <- function(sim_df = NULL, write_rds = FALSE) {
if(is.null(sim_df)) {
sim_df <- gamp::sim_diff_variance_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
ref_se = .25,
se_ratio_grid = seq(from = .5, to = 2, length.out = 100),
fx_diff_norm_grid = seq(
from = 0, to = 1, length.out = 100
) / gamp:::get_theo_obs_noise(se = .25, n = 1.5e05, maf = .4),
sims_per_grid_pt = 1
)
}
if(write_rds) {
readr::write_rds(sim_df, "./rds_data/fig2_df.rds")
}
sim_df <- sim_df %>%
dplyr::mutate(mse_diff_e1 = mse_e1_additive - mse_e1_GxE)
ggplot(data = sim_df, aes(x = fx_diff_norm, y = se, fill = mse_diff_e1)) +
geom_tile() +
scale_fill_gradient2() +
ylab(latex2exp::TeX("$\\frac{\\sigma_{1}}{\\sigma_{0}}$")) +
xlab(latex2exp::TeX("$\\frac{|\\beta_{1}^{(0)} - \\beta_{1}^{(1)}|}{\\sigma_{0}}$"))
}
sim_df <- readr::read_rds("./rds_data/fig2_df.rds")
generate_fig2(sim_df)
# code for figure 2
set.seed(1)
'%>%' <- magrittr::'%>%'
library(ggplot2)
generate_fig2 <- function(sim_df = NULL, write_rds = FALSE) {
if(is.null(sim_df)) {
sim_df <- gamp::sim_diff_variance_2env(
n_e0 = 1.5e05,
n_e1 = 1.5e05,
ref_se = .25,
se_ratio_grid = seq(from = .5, to = 2, length.out = 100),
fx_diff_norm_grid = seq(
from = 0, to = 1, length.out = 100
) / gamp:::get_theo_obs_noise(se = .25, n = 1.5e05, maf = .4),
sims_per_grid_pt = 1
)
}
if(write_rds) {
readr::write_rds(sim_df, "./rds_data/fig2_df.rds")
}
sim_df <- sim_df %>%
dplyr::mutate(mse_diff_e1 = mse_e1_additive - mse_e1_GxE)
ggplot(data = sim_df, aes(x = fx_diff_norm, y = se_ratio, fill = mse_diff_e1)) +
geom_tile() +
scale_fill_gradient2() +
ylab(latex2exp::TeX("$\\frac{\\sigma_{1}}{\\sigma_{0}}$")) +
xlab(latex2exp::TeX("$\\frac{|\\beta_{1}^{(0)} - \\beta_{1}^{(1)}|}{\\sigma_{0}}$"))
}
# subsequent analysis
sim_df <- readr::read_rds("./rds_data/fig2_df.rds")
generate_fig2(sim_df)
# subsequent analysis
sim_df <- readr::read_rds("./rds_data/fig2_df.rds")
generate_fig2(sim_df)
