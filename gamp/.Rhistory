scale_y_continuous(
breaks = seq(1, length(perc_better_vec)),
labels = names(perc_better_vec)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
)
library(ggbreak)
g_p_val_trait_dist <- ggplot(data = perc_better_df %>% dplyr::filter(criterion == "p < 5e-8")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_vec)),
labels = names(perc_better_vec)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
)
#png(
#  file = "~/Documents/paper_gwas_amplification/images/fig3.png",
#  width = 4000,
#  height = 2000,
#  res = 300
#)
traits_fig <- ggarrange(
g_igf1, #+ rremove("ylab") + rremove("xlab"),
g_igf1_top_hits, # + rremove("ylab") + rremove("xlab"),
g_all_trait_dist,
g_p_val_trait_dist,
labels = "AUTO",
nrow = 2,
ncol = 2
)
traits_fig
g_all_trait_dist <- ggplot(data = perc_better_df %>% dplyr::filter(criterion == "all")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_vec)),
labels = names(perc_better_vec)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
)
library(ggbreak)
g_p_val_trait_dist <- ggplot(data = perc_better_df %>% dplyr::filter(criterion == "p < 5e-8")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_top_hits_vec)),
labels = names(perc_better_top_hitsvec)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
)
g_p_val_trait_dist <- ggplot(data = perc_better_df %>% dplyr::filter(criterion == "p < 5e-8")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_vec_top_hits_vec)),
labels = names(perc_better_top_hitsvec)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
)
g_p_val_trait_dist <- ggplot(data = perc_better_df %>% dplyr::filter(criterion == "p < 5e-8")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_vec_top_hits)),
labels = names(perc_better_top_hitsvec)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
)
g_p_val_trait_dist <- ggplot(data = perc_better_df %>% dplyr::filter(criterion == "p < 5e-8")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_vec_top_hits)),
labels = names(perc_better_vec_top_hits)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
)
#png(
#  file = "~/Documents/paper_gwas_amplification/images/fig3.png",
#  width = 4000,
#  height = 2000,
#  res = 300
#)
traits_fig <- ggarrange(
g_igf1, #+ rremove("ylab") + rremove("xlab"),
g_igf1_top_hits, # + rremove("ylab") + rremove("xlab"),
g_all_trait_dist,
g_p_val_trait_dist,
labels = "AUTO",
nrow = 2,
ncol = 2
)
traits_fig
traits_fig <- ggarrange(
g_igf1, #+ rremove("ylab") + rremove("xlab"),
g_all_trait_dist,
g_igf1_top_hits, # + rremove("ylab") + rremove("xlab"),
g_p_val_trait_dist,
labels = "AUTO",
nrow = 2,
ncol = 2,
width
)
traits_fig <- ggarrange(
g_igf1, #+ rremove("ylab") + rremove("xlab"),
g_all_trait_dist,
g_igf1_top_hits, # + rremove("ylab") + rremove("xlab"),
g_p_val_trait_dist,
labels = "AUTO",
nrow = 2,
ncol = 2
)
traits_fig
traits_fig <- ggarrange(
g_igf1, #+ rremove("ylab") + rremove("xlab"),
g_all_trait_dist,
g_igf1_top_hits, # + rremove("ylab") + rremove("xlab"),
g_p_val_trait_dist,
labels = "AUTO",
nrow = 2,
ncol = 2,
widths = c(1, 2)
)
traits_fig
traits_fig <- ggarrange(
g_igf1, #+ rremove("ylab") + rremove("xlab"),
g_all_trait_dist,
g_igf1_top_hits, # + rremove("ylab") + rremove("xlab"),
g_p_val_trait_dist,
labels = "AUTO",
nrow = 2,
ncol = 2,
widths = c(1, 2),
heights = c(1,2)
)
traits_fig
help(ggarrange)
traits_fig <- ggarrange(
g_igf1, #+ rremove("ylab") + rremove("xlab"),
g_all_trait_dist,
g_igf1_top_hits, # + rremove("ylab") + rremove("xlab"),
g_p_val_trait_dist,
labels = "AUTO",
nrow = 2,
ncol = 2,
widths = c(1, 2,3 ,1),
heights = c(1,2, 3, 1)
)v
traits_fig <- ggarrange(
g_igf1, #+ rremove("ylab") + rremove("xlab"),
g_all_trait_dist,
g_igf1_top_hits, # + rremove("ylab") + rremove("xlab"),
g_p_val_trait_dist,
labels = "AUTO",
nrow = 2,
ncol = 2,
widths = c(1, 2,3 ,1),
heights = c(1,2, 3, 1)
)
traits_fig
traits_fig <- ggarrange(
g_igf1, #+ rremove("ylab") + rremove("xlab"),
g_all_trait_dist,
g_igf1_top_hits, # + rremove("ylab") + rremove("xlab"),
g_p_val_trait_dist,
labels = "AUTO",
nrow = 2,
ncol = 2,
widths = c(1, 2)
)
traits_fig
3
traits_fig
g_igf1_top_hits <- ggplot(data = igf1_info_top_hits$cv_df, aes(x = fx_diff, y = se_m)) +
geom_point(alpha = .25, color = "orange", size = 1) +
geom_segment(aes(x = 0, y = 0, xend = .2, yend = .2 * igf1_info$slope), linetype = "dashed") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(hjust = 0.5, size = 14), axis.title = element_text(size = 8)) +
xlab("Difference in Environment Specific Effects (nmol/L)") +
ylab("Standard Error (nmol/L)")
xlim(0, .2) +
ylim(0, (1/3))
6
g_igf1_top_hits <- ggplot(data = igf1_info_top_hits$cv_df, aes(x = fx_diff, y = se_m)) +
geom_point(alpha = .25, color = "orange", size = 1) +
geom_segment(aes(x = 0, y = 0, xend = .2, yend = .2 * igf1_info$slope), linetype = "dashed") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(hjust = 0.5, size = 14), axis.title = element_text(size = 8)) +
xlab("Difference in Environment Specific Effects (nmol/L)") +
ylab("Standard Error (nmol/L)")
xlim(0, .2) +
ylim(0, (1/3))
g_igf1_top_hits <- ggplot(data = igf1_info_top_hits$cv_df, aes(x = fx_diff, y = se_m)) +
geom_point(alpha = .25, color = "orange", size = 1) +
geom_segment(aes(x = 0, y = 0, xend = .2, yend = .2 * igf1_info$slope), linetype = "dashed") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(hjust = 0.5, size = 14), axis.title = element_text(size = 8)) +
xlab("Difference in Environment Specific Effects (nmol/L)") +
ylab("Standard Error (nmol/L)") +
xlim(0, .2) +
ylim(0, (1/3))
g_igf1 <- ggplot(data = igf1_info$cv_df, aes(x = fx_diff, y = se_m)) +
geom_point(alpha = .15, color = "orange", size = 1) +
geom_segment(aes(x = 0, y = 0, xend = .2, yend = .2 * igf1_info$slope), linetype = "dashed") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
plot.title = element_text(hjust = 0.5, size = 14), axis.title = element_text(size = 8)) +
xlab("Difference in Environment Specific Effects (nmol/L)") +
ylab("Standard Error (nmol/L)") +
ggtitle("IGF1") +
xlim(0, .2) +
ylim(0, 4)
g_all_trait_dist <- ggplot(data = perc_better_df %>% dplyr::filter(criterion == "all")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_vec)),
labels = names(perc_better_vec)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5, size = 14),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
) +
ggtitle("27 Selected Traits")
g_p_val_trait_dist <- ggplot(data = perc_better_df %>% dplyr::filter(criterion == "p < 5e-8")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_vec_top_hits)),
labels = names(perc_better_vec_top_hits)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
)
traits_fig <- ggarrange(
g_igf1, #+ rremove("ylab") + rremove("xlab"),
g_all_trait_dist,
g_igf1_top_hits, # + rremove("ylab") + rremove("xlab"),
g_p_val_trait_dist,
labels = "AUTO",
nrow = 2,
ncol = 2,
widths = c(1, 2)
)
traits_fig
library(ggbreak)
g_all_trait_dist <- ggplot(data = perc_better_df %>% dplyr::filter(criterion == "all")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_vec)),
labels = names(perc_better_vec)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5, size = 14),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
) +
ggtitle("27 Selected Traits") +
scale_x_break(c(.15, .4))
g_all_trait_dist
help("scale_x_break")
ggplot(data = perc_better_df %>% dplyr::filter(criterion == "all")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_vec)),
labels = names(perc_better_vec)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5, size = 14),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
) +
ggtitle("27 Selected Traits") +
scale_x_break(c(.15, .4))
ggplot(data = perc_better_df %>% dplyr::filter(criterion == "all")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_vec)),
labels = names(perc_better_vec)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5, size = 14),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
) +
ggtitle("27 Selected Traits") +
scale_x_cut(c(.15, .4))
ggplot(data = perc_better_df %>% dplyr::filter(criterion == "all")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_vec)),
labels = names(perc_better_vec)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5, size = 14),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
) +
ggtitle("27 Selected Traits")
g_p_val_trait_dist <- ggplot(data = perc_better_df %>% dplyr::filter(criterion == "p < 5e-8")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_vec_top_hits)),
labels = names(perc_better_vec_top_hits)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
)
g_all_trait_dist <- ggplot(data = perc_better_df %>% dplyr::filter(criterion == "all")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_vec)),
labels = names(perc_better_vec)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5, size = 14),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
) +
ggtitle("27 Selected Traits")
traits_fig <- ggarrange(
g_igf1, #+ rremove("ylab") + rremove("xlab"),
g_all_trait_dist,
g_igf1_top_hits, # + rremove("ylab") + rremove("xlab"),
g_p_val_trait_dist,
labels = "AUTO",
nrow = 2,
ncol = 2,
widths = c(1, 1.5)
)
traits_fig
install.packages("plotrix")
library(plotrix)
help("axis.break")
g_p_val_trait_dist <- ggplot(data = perc_better_df %>% dplyr::filter(criterion == "p < 5e-8")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_vec_top_hits)),
labels = names(perc_better_vec_top_hits)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
plot.tag.position=c(1.25, 0.5)
) +
labs(tag = "Genome-wide Significant\n in Males")
g_p_val_trait_dist
ggplot(data = perc_better_df %>% dplyr::filter(criterion == "p < 5e-8")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_vec_top_hits)),
labels = names(perc_better_vec_top_hits)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
plot.tag.position=c(1.25, 0.5),
legend.box.margin=margin(l=20)
) +
labs(tag = "Genome-wide Significant\n in Males")
g_p_val_trait_dist <- ggplot(data = perc_better_df %>% dplyr::filter(criterion == "p < 5e-8")) +
geom_point(aes(x = perc_better, y = y)) +
scale_y_continuous(
breaks = seq(1, length(perc_better_vec_top_hits)),
labels = names(perc_better_vec_top_hits)
) +
ylab("Trait") +
xlab("Percent of Effects Better Estimated with GxE Model") +
theme(
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
)
#png(
#  file = "~/Documents/paper_gwas_amplification/images/fig3.png",
#  width = 4000,
#  height = 2000,
#  res = 300
#)
traits_fig <- ggarrange(
g_igf1, #+ rremove("ylab") + rremove("xlab"),
g_all_trait_dist,
g_igf1_top_hits, # + rremove("ylab") + rremove("xlab"),
g_p_val_trait_dist,
labels = "AUTO",
nrow = 2,
ncol = 2,
widths = c(1, 1.5)
)
traits_fig
help(ggarrange)
traits_fig <- ggarrange(
g_igf1, #+ rremove("ylab") + rremove("xlab"),
g_all_trait_dist,
NULL,
g_igf1_top_hits, # + rremove("ylab") + rremove("xlab"),
g_p_val_trait_dist,
NULL,
labels = c("A", "B", "", "C", "D", ""),
nrow = 2,
ncol = 3,
widths = c(1, 1.5, .25)
)
traits_fig
traits_fig
traits_fig <- ggarrange(
g_igf1, #+ rremove("ylab") + rremove("xlab"),
g_all_trait_dist,
NULL,
g_igf1_top_hits, # + rremove("ylab") + rremove("xlab"),
g_p_val_trait_dist,
NULL,
labels = c("A", "B", "", "C", "D", ""),
nrow = 2,
ncol = 3,
widths = c(1, (1 + (1/3)), .5)
)
traits_fig
